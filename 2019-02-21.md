# Utilización de técnicas de programación segura:
 -	Prácticas de programación segura.
 -	Criptografía de clave pública y clave privada.
 -	Principales aplicaciones de la criptografía.
 -	Protocolos criptográficos.
 -	Política de seguridad.
 -	Programación de mecanismos de control de acceso.
 -	Encriptación de información.
 -	Protocolos seguros de comunicaciones.
 -	Programación de aplicaciones con comunicaciones seguras.

----------------------

# Técnicas simples
- Transposición
- Sustitución

# Descrifrar el siguiente texto
```
CEEHKYI             DFFILZRK            EGGJM[Y             FHHKRKW             GIILY               HJJN                IKKOQW]             BDDHJTNW            CEEIKZI             DFFJPI              EGGKQJNZ            FHHRNÛZ             GIISY               HJJVLZgOacV         IKKWQN`             BDDPTXPW            CEEQUYQX]           DFFR\I[^L^          EGGULN\L^           FHHVMYYMQ]          GIIWNZZN`           HJJXO[[OacV         IKKYP\\^            BDDRNIHZ            CEESOJW             DFFTPY^OZ           EGGUQZ_P^\          FHHV]Y              GII[K_MZWT^ea       HJJ\L`N`            IKK]MaOacV          BDDVHG              CEEWIHZ             DFFXX]RVWMZWT^ea    EGGYY^SWXN`         FHHZ[KRM[O\YV`gc    GII[\LZPOa          HJJ\][aOS_          IKK]^\bPb           BDDVWU[M            CEEXOKI\            DFFY[I[NL^          EGGZ\NMPP\`         FHH[]ONQ_           GII\^POV[XU_fb      HJJ]_[              IKK_MaOa            BDDXJ               CEEYOITN            DFFZPLX             EGG[QVSPZa]         FHH\R\              GII]S]_R            HJJdZZ              IKNTONQX__          BDGMHGY             CEHTSLV             DFIUTQWKW           EGJ\KLSZZ           FHK]L^Z^            GIMLO               HJNMPPN`X_          IKOOaY              BDHNF               CEIOGYZXX           DFJPLZX             EGKQWW              FHLRX\][            GIMUWZ_P]           HJNVWMPOS_          IKO]^NQX__          BDHVWGU\N           CEIWXHZ             DFJX[][K            EGKZ\XVL            FHL\JV              GIM]Y               HJN^`ZNR^           IKSLPNb^            BDLIWZHUNX_Q        CEMJX[W             DFNK[ILOL_          EGONI[\LP\          FHPOJ\]MZWT^ea      GIQPK]^N`           HJRQPMa]            IKSY`RacQea         BDLWFR              CEMXOUQJ            DFNYPVRY            EGOZUJV             FHP[VK]             GIQ\WL`VQ^          HJR]X[              IKT`^NQX__          BDMYWGY             CEPFIPWW            DFQGULJWTQ[b^       EGRHVMK]            FHSIWNL^`S          GITJ^Tb\            HJU_NU\\            IKXPSNQX__          BDQILGKW            CESGGKW             DFTHHUROY`\         EGUJIMY             FHVKJ\OMQ]          GIWLK]PN`           HJXMP`NR^           IKYNQaOa            BDRGNTHLX           CESHOUIVSPZa]       DFTIPVJ\            EGUJPX\YMQ]         FHVKQY]ZN`          GIWOO_QN`           HJXQLOVO            IKYRMQO             BDRKFJV             CESLGY              DFTRHbJ\            EGUSMWQZ            FHVTRMT[[           GIWUSNU\\Xc^a       HJXVTOV]]YdfT       IKYWU_              BDRPXGKW            CESQRHLX            DFTRSIM_]M          EGUSTJ\             FHVTUYYMQcaQ        GIWUVZZN`           HJXWMMQ]            IKYXNN`             BDRQNTHJUO          CESROUILSZZ         DFTSPVJ\            EGUUIKVP            FHVVJNZ             GIWWK]              HJXXL^R             IKYYM_aT            BDRRT               CESV[PTUKO[         DFTXKIKVP           EGUYLJNZ^           FHVZMKUQ            GIW[NL^             HJX\TSR\            IKY]UTS]Ud          BDRVWKJMMY]         CESWXLKN\           DFTXYMLSMXR         EGUYZNMTYVS]d`      FHVZ[ORMQ]          GIW[^LP\            HJX\_M_             IKY]`Vd^            BDRVYU              CESYGNIMY           DFTZHOJWTQ[b^       EGU[IPK]_R          FHV\XXLP\`          GIW]YYM_            HJX^ZZN`bU          IKYaQQOS_           BDRZJJHZ            CES^GY              DFT`HTJ\            EGXH                FHYILKOMO`P         GIZJML^             HJ[KSM[             IK\L_NR^            BDUEXGKW[           CEVFYHZ             DFWGZI[]P           EGXH[RYY            FHYI\Sa[            GIZJdLPR`P          HJ[KeMQ]a           IK\LfN[XU_fb        BDUE_GY             CEVF`HZ\O           DFWGaW              EGXLJX^PXYOb        FHYMLK]`Na          GIZNVL`Na           HJ[OaMQSa_          IK\PbNR^b           BDUI[GY             CEVJ\PILSZZ         DFWK]QJNLYR\cU      EGXL^RKO[           FHYM_SL^            GIZN`TMacaQ         HJ[SOQ_]            IK\TP\`             BDUMIUYI            CEVNMHLN\Z          DFWONIMY            EGXPOJNZ_           FHYQPK]             GIZRQL^`S           HJ[SR[
```

----------------------

# PowerShell
## Criptografía en PowerShell
https://www.jesusninoc.com/2017/02/01/criptografia-en-powershell/
- Análisis de frecuencias de letras en un texto con PowerShell (parte 1)
- Análisis de frecuencias de letras en un texto con PowerShell (parte 2)
- Análisis de frecuencias de letras en un texto con PowerShell (parte 3)
- Análisis de frecuencias de palabras en un texto con PowerShell (parte 4)
- Análisis de frecuencias de palabras en el libro „El ingenioso hidalgo Don Quijote de la Mancha“ con PowerShell (parte 5)
- Análisis de frecuencias de letras en el libro “El ingenioso hidalgo Don Quijote de la Mancha” con PowerShell (parte 6)
- Análisis de frecuencias de letras en el libro “El Principito” con PowerShell (parte 6)
- Análisis de frecuencias de letras en el libro “The Comedy of Errors” con PowerShell (parte 6)
- Análisis y representación de frecuencias de letras en el libro “El ingenioso hidalgo Don Quijote de la Mancha” con PowerShell (parte 7)
- Cifrar de forma sencilla el libro “El ingenioso hidalgo Don Quijote de la Mancha” con PowerShell (parte 8)
- Análisis y representación de frecuencias de letras en el libro “El ingenioso hidalgo Don Quijote de la Mancha” cifrado y sin cifrar con PowerShell (parte 9)
- Cifrar de forma compleja el libro “El ingenioso hidalgo Don Quijote de la Mancha” con PowerShell (parte 10)

##  Aproximación al cifrado y descifrado en PowerShell
https://www.jesusninoc.com/2017/02/23/aproximacion-al-cifrado-y-descifrado-en-powershell/

----------------------

# Análisis de frecuencias
## Código de Java - Contar las veces que aparece una palabra en un texto
```Java
import java.util.StringTokenizer;
import java.util.Scanner;
 
class PalabrasRepetidas {
 
	public static void main(String[] args) {
 
		//Creamos un objeto de la clase Scanner para leer por teclado
		Scanner miScanner = new Scanner(System.in);
 
		System.out.println("Introduce una frase: ");
 
		//Se almacena el texto introducido en la variable frase y pasa el
		//texto todo a minúsculas
		String frase = miScanner.nextLine().toLowerCase();
 
		//Se crea el objeto tok de la clase StringTokenizer
		StringTokenizer tok = new StringTokenizer(frase);
 
		//Variable que almacenará la palabra que queramos bucar
		String palabraBuscar;
 
		//Variable que almacena el número de veces que aparece la palabra
		int contador = 0;
 
		System.out.print("Introduce la palabra a contar: ");
 
		//Se introduce la palabra a buscar pasándola toda a minúscula
		palabraBuscar = miScanner.nextLine().toLowerCase();
 
		/*
		Bucle while que se repetirá mientras que existan tokens. Dentro del
		bucle se crea un condicional if que compara si el elemento es igual a
		la palabra a buscar. En caso de que así se el contador aumentará en uno
		*/
		while(tok.hasMoreTokens()) {
			if(tok.nextElement().equals(palabraBuscar)) {
				contador++;
			}
		}
 
		System.out.println("La frase '" + frase + "'\ncontine " + contador + " veces la palabra '" + palabraBuscar + "'");
 
	}
 
}
```

----------------------

# Criptoanálisis
- Criptoanálisis básico con PowerShell (parte 1)
- Criptoanálisis básico con PowerShell (parte 2)

# CCN-STIC-807 – Criptografía de empleo en el ENS
|Tipo de Algoritmo| Acreditados por el CCN|
|--|--
|Cifrado Simétrico|TDEA (Triple Data Encryption Algorithm)
||AES (Advanced Encryption Standard)
|Algoritmos Asimétricos|DSA (Digital Signature Algorithm)
||ECDSA (Elliptic Curve Digital Signature Algorithm)
||RSA (Criptosistema RSA)
||ECIES (Elliptic Curve Integrated Encryption Scheme)
|Intercambio de Clave|DH o DHKA (Diffie-Hellman Key Agreement)
||MQV (Menezes-Qu-Vanstone Key Agreement)
||ECDH (Elliptic Curve Diffie-Hellman)
||ECMQV (Elliptic Curve Menezes-Qu-Vanstone)
|Funciones resumen (Hash)|SHA-2 (Secure Hash Algorithm)
||HMAC (Hash Message Authentication Code )

----------------------

# Cifrado simétrico
- TDEA (Triple Data Encryption Algorithm)
- AES (Advanced Encryption Standard)

```Java
/* Con clave aleatoria */

import javax.crypto.*;    
import java.security.*;  

public class Java {

	private static SecretKey key = null;         
	private static Cipher cipher = null; 

	public static void main(String[] args) throws Exception
	{
		KeyGenerator keyGenerator = KeyGenerator.getInstance("AES");
		keyGenerator.init(128);
		SecretKey secretKey = keyGenerator.generateKey();
		cipher = Cipher.getInstance("AES");

		String clearText = "hola";
		byte[] clearTextBytes = clearText.getBytes("UTF8");
		System.out.println("Texto en claro: " + clearText);
		System.out.println("Texto en Bytes claro: " + clearTextBytes);

		cipher.init(Cipher.ENCRYPT_MODE, secretKey);
		byte[] cipherBytes = cipher.doFinal(clearTextBytes);
		String cipherText = new String(cipherBytes, "UTF8");
		System.out.println("Texto cifrado: " + cipherText);
		System.out.println("Texto en Bytes cifrado: " + cipherBytes);

		cipher.init(Cipher.DECRYPT_MODE, secretKey);
		byte[] decryptedBytes = cipher.doFinal(cipherBytes);
		String decryptedText = new String(decryptedBytes, "UTF8");
		System.out.println("Texto descifrado: " + decryptedText);
		System.out.println("Texto en Bytes cifrado: " + decryptedBytes);
	}
}
```

```Java
/* Con clave añadida*/

import javax.crypto.*;
import javax.crypto.spec.SecretKeySpec;
import java.security.*;
import java.util.Base64;

public class Java {

	private static Cipher cipher = null; 

	public static void main(String[] args) throws Exception{
		// Clave -> Clave en base 64
		// 1234567891234567 -> MTIzNDU2Nzg5MTIzNDU2Nw==
		// decode the base64 encoded string
		byte[] decodedKey = Base64.getDecoder().decode("MTIzNDU2Nzg5MTIzNDU2Nw==");
		
		// rebuild key using SecretKeySpec
		SecretKey originalKey = new SecretKeySpec(decodedKey, 0, decodedKey.length, "AES");
		System.out.println("originalKey: " + decodedKey);
		
		cipher = Cipher.getInstance("AES");

		String clearText = "hola";
		byte[] clearTextBytes = clearText.getBytes("UTF8");
		System.out.println("Texto en claro: " + clearText);

		cipher.init(Cipher.ENCRYPT_MODE, originalKey);
		byte[] cipherBytes = cipher.doFinal(clearTextBytes);
		String cipherText = new String(cipherBytes, "UTF8");
		System.out.println("Texto cifrado: " + cipherText);

		cipher.init(Cipher.DECRYPT_MODE, originalKey);
		byte[] decryptedBytes = cipher.doFinal(cipherBytes);
		String decryptedText = new String(decryptedBytes, "UTF8");
		System.out.println("Texto descifrado: " + decryptedText);
	}
}
```
